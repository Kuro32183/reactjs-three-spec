{"ast":null,"code":"/**\n * @author arodic / https://github.com/arodic\n */\n\nimport { BoxBufferGeometry, BufferGeometry, Color, CylinderBufferGeometry, DoubleSide, Euler, Float32BufferAttribute, Line, LineBasicMaterial, Matrix4, Mesh, MeshBasicMaterial, Object3D, OctahedronBufferGeometry, PlaneBufferGeometry, Quaternion, Raycaster, SphereBufferGeometry, TorusBufferGeometry, Vector3 } from \"../../../build/three.module.js\";\nvar TransformControls = function TransformControls(camera, domElement) {\n  if (domElement === undefined) {\n    console.warn('THREE.TransformControls: The second parameter \"domElement\" is now mandatory.');\n    domElement = document;\n  }\n  Object3D.call(this);\n  this.visible = false;\n  this.domElement = domElement;\n  var _gizmo = new TransformControlsGizmo();\n  this.add(_gizmo);\n  var _plane = new TransformControlsPlane();\n  this.add(_plane);\n  var scope = this;\n\n  // Define properties with getters/setter\n  // Setting the defined property will automatically trigger change event\n  // Defined properties are passed down to gizmo and plane\n\n  defineProperty(\"camera\", camera);\n  defineProperty(\"object\", undefined);\n  defineProperty(\"enabled\", true);\n  defineProperty(\"axis\", null);\n  defineProperty(\"mode\", \"translate\");\n  defineProperty(\"translationSnap\", null);\n  defineProperty(\"rotationSnap\", null);\n  defineProperty(\"scaleSnap\", null);\n  defineProperty(\"space\", \"world\");\n  defineProperty(\"size\", 1);\n  defineProperty(\"dragging\", false);\n  defineProperty(\"showX\", true);\n  defineProperty(\"showY\", true);\n  defineProperty(\"showZ\", true);\n  var changeEvent = {\n    type: \"change\"\n  };\n  var mouseDownEvent = {\n    type: \"mouseDown\"\n  };\n  var mouseUpEvent = {\n    type: \"mouseUp\",\n    mode: scope.mode\n  };\n  var objectChangeEvent = {\n    type: \"objectChange\"\n  };\n\n  // Reusable utility variables\n\n  var raycaster = new Raycaster();\n  function intersectObjectWithRay(object, raycaster, includeInvisible) {\n    var allIntersections = raycaster.intersectObject(object, true);\n    for (var i = allIntersections.length; i--;) {\n      if (allIntersections[i].object.visible || includeInvisible) {\n        return allIntersections[i];\n      }\n    }\n    return false;\n  }\n  var _tempVector = new Vector3();\n  var _tempVector2 = new Vector3();\n  var _tempQuaternion = new Quaternion();\n  var _unit = {\n    X: new Vector3(1, 0, 0),\n    Y: new Vector3(0, 1, 0),\n    Z: new Vector3(0, 0, 1)\n  };\n  var pointStart = new Vector3();\n  var pointEnd = new Vector3();\n  var offset = new Vector3();\n  var rotationAxis = new Vector3();\n  var startNorm = new Vector3();\n  var endNorm = new Vector3();\n  var rotationAngle = 0;\n  var cameraPosition = new Vector3();\n  var cameraQuaternion = new Quaternion();\n  var cameraScale = new Vector3();\n  var parentPosition = new Vector3();\n  var parentQuaternion = new Quaternion();\n  var parentQuaternionInv = new Quaternion();\n  var parentScale = new Vector3();\n  var worldPositionStart = new Vector3();\n  var worldQuaternionStart = new Quaternion();\n  var worldScaleStart = new Vector3();\n  var worldPosition = new Vector3();\n  var worldQuaternion = new Quaternion();\n  var worldQuaternionInv = new Quaternion();\n  var worldScale = new Vector3();\n  var eye = new Vector3();\n  var positionStart = new Vector3();\n  var quaternionStart = new Quaternion();\n  var scaleStart = new Vector3();\n\n  // TODO: remove properties unused in plane and gizmo\n\n  defineProperty(\"worldPosition\", worldPosition);\n  defineProperty(\"worldPositionStart\", worldPositionStart);\n  defineProperty(\"worldQuaternion\", worldQuaternion);\n  defineProperty(\"worldQuaternionStart\", worldQuaternionStart);\n  defineProperty(\"cameraPosition\", cameraPosition);\n  defineProperty(\"cameraQuaternion\", cameraQuaternion);\n  defineProperty(\"pointStart\", pointStart);\n  defineProperty(\"pointEnd\", pointEnd);\n  defineProperty(\"rotationAxis\", rotationAxis);\n  defineProperty(\"rotationAngle\", rotationAngle);\n  defineProperty(\"eye\", eye);\n  {\n    domElement.addEventListener(\"mousedown\", onPointerDown, false);\n    domElement.addEventListener(\"touchstart\", onPointerDown, false);\n    domElement.addEventListener(\"mousemove\", onPointerHover, false);\n    domElement.addEventListener(\"touchmove\", onPointerHover, false);\n    domElement.addEventListener(\"touchmove\", onPointerMove, false);\n    document.addEventListener(\"mouseup\", onPointerUp, false);\n    domElement.addEventListener(\"touchend\", onPointerUp, false);\n    domElement.addEventListener(\"touchcancel\", onPointerUp, false);\n    domElement.addEventListener(\"touchleave\", onPointerUp, false);\n  }\n  this.dispose = function () {\n    domElement.removeEventListener(\"mousedown\", onPointerDown);\n    domElement.removeEventListener(\"touchstart\", onPointerDown);\n    domElement.removeEventListener(\"mousemove\", onPointerHover);\n    document.removeEventListener(\"mousemove\", onPointerMove);\n    domElement.removeEventListener(\"touchmove\", onPointerHover);\n    domElement.removeEventListener(\"touchmove\", onPointerMove);\n    document.removeEventListener(\"mouseup\", onPointerUp);\n    domElement.removeEventListener(\"touchend\", onPointerUp);\n    domElement.removeEventListener(\"touchcancel\", onPointerUp);\n    domElement.removeEventListener(\"touchleave\", onPointerUp);\n    this.traverse(function (child) {\n      if (child.geometry) child.geometry.dispose();\n      if (child.material) child.material.dispose();\n    });\n  };\n\n  // Set current object\n  this.attach = function (object) {\n    this.object = object;\n    this.visible = true;\n    return this;\n  };\n\n  // Detatch from object\n  this.detach = function () {\n    this.object = undefined;\n    this.visible = false;\n    this.axis = null;\n    return this;\n  };\n\n  // Defined getter, setter and store for a property\n  function defineProperty(propName, defaultValue) {\n    var propValue = defaultValue;\n    Object.defineProperty(scope, propName, {\n      get: function get() {\n        return propValue !== undefined ? propValue : defaultValue;\n      },\n      set: function set(value) {\n        if (propValue !== value) {\n          propValue = value;\n          _plane[propName] = value;\n          _gizmo[propName] = value;\n          scope.dispatchEvent({\n            type: propName + \"-changed\",\n            value: value\n          });\n          scope.dispatchEvent(changeEvent);\n        }\n      }\n    });\n    scope[propName] = defaultValue;\n    _plane[propName] = defaultValue;\n    _gizmo[propName] = defaultValue;\n  }\n\n  // updateMatrixWorld  updates key transformation variables\n  this.updateMatrixWorld = function () {\n    if (this.object !== undefined) {\n      this.object.updateMatrixWorld();\n      if (this.object.parent === null) {\n        console.error('TransformControls: The attached 3D object must be a part of the scene graph.');\n      } else {\n        this.object.parent.matrixWorld.decompose(parentPosition, parentQuaternion, parentScale);\n      }\n      this.object.matrixWorld.decompose(worldPosition, worldQuaternion, worldScale);\n      parentQuaternionInv.copy(parentQuaternion).inverse();\n      worldQuaternionInv.copy(worldQuaternion).inverse();\n    }\n    this.camera.updateMatrixWorld();\n    this.camera.matrixWorld.decompose(cameraPosition, cameraQuaternion, cameraScale);\n    eye.copy(cameraPosition).sub(worldPosition).normalize();\n    Object3D.prototype.updateMatrixWorld.call(this);\n  };\n  this.pointerHover = function (pointer) {\n    if (this.object === undefined || this.dragging === true || pointer.button !== undefined && pointer.button !== 0) return;\n    raycaster.setFromCamera(pointer, this.camera);\n    var intersect = intersectObjectWithRay(_gizmo.picker[this.mode], raycaster);\n    if (intersect) {\n      this.axis = intersect.object.name;\n    } else {\n      this.axis = null;\n    }\n  };\n  this.pointerDown = function (pointer) {\n    if (this.object === undefined || this.dragging === true || pointer.button !== undefined && pointer.button !== 0) return;\n    if ((pointer.button === 0 || pointer.button === undefined) && this.axis !== null) {\n      raycaster.setFromCamera(pointer, this.camera);\n      var planeIntersect = intersectObjectWithRay(_plane, raycaster, true);\n      if (planeIntersect) {\n        var space = this.space;\n        if (this.mode === 'scale') {\n          space = 'local';\n        } else if (this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ') {\n          space = 'world';\n        }\n        if (space === 'local' && this.mode === 'rotate') {\n          var snap = this.rotationSnap;\n          if (this.axis === 'X' && snap) this.object.rotation.x = Math.round(this.object.rotation.x / snap) * snap;\n          if (this.axis === 'Y' && snap) this.object.rotation.y = Math.round(this.object.rotation.y / snap) * snap;\n          if (this.axis === 'Z' && snap) this.object.rotation.z = Math.round(this.object.rotation.z / snap) * snap;\n        }\n        this.object.updateMatrixWorld();\n        this.object.parent.updateMatrixWorld();\n        positionStart.copy(this.object.position);\n        quaternionStart.copy(this.object.quaternion);\n        scaleStart.copy(this.object.scale);\n        this.object.matrixWorld.decompose(worldPositionStart, worldQuaternionStart, worldScaleStart);\n        pointStart.copy(planeIntersect.point).sub(worldPositionStart);\n      }\n      this.dragging = true;\n      mouseDownEvent.mode = this.mode;\n      this.dispatchEvent(mouseDownEvent);\n    }\n  };\n  this.pointerMove = function (pointer) {\n    var axis = this.axis;\n    var mode = this.mode;\n    var object = this.object;\n    var space = this.space;\n    if (mode === 'scale') {\n      space = 'local';\n    } else if (axis === 'E' || axis === 'XYZE' || axis === 'XYZ') {\n      space = 'world';\n    }\n    if (object === undefined || axis === null || this.dragging === false || pointer.button !== undefined && pointer.button !== 0) return;\n    raycaster.setFromCamera(pointer, this.camera);\n    var planeIntersect = intersectObjectWithRay(_plane, raycaster, true);\n    if (!planeIntersect) return;\n    pointEnd.copy(planeIntersect.point).sub(worldPositionStart);\n    if (mode === 'translate') {\n      // Apply translate\n\n      offset.copy(pointEnd).sub(pointStart);\n      if (space === 'local' && axis !== 'XYZ') {\n        offset.applyQuaternion(worldQuaternionInv);\n      }\n      if (axis.indexOf('X') === -1) offset.x = 0;\n      if (axis.indexOf('Y') === -1) offset.y = 0;\n      if (axis.indexOf('Z') === -1) offset.z = 0;\n      if (space === 'local' && axis !== 'XYZ') {\n        offset.applyQuaternion(quaternionStart).divide(parentScale);\n      } else {\n        offset.applyQuaternion(parentQuaternionInv).divide(parentScale);\n      }\n      object.position.copy(offset).add(positionStart);\n\n      // Apply translation snap\n\n      if (this.translationSnap) {\n        if (space === 'local') {\n          object.position.applyQuaternion(_tempQuaternion.copy(quaternionStart).inverse());\n          if (axis.search('X') !== -1) {\n            object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\n          }\n          if (axis.search('Y') !== -1) {\n            object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\n          }\n          if (axis.search('Z') !== -1) {\n            object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\n          }\n          object.position.applyQuaternion(quaternionStart);\n        }\n        if (space === 'world') {\n          if (object.parent) {\n            object.position.add(_tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n          }\n          if (axis.search('X') !== -1) {\n            object.position.x = Math.round(object.position.x / this.translationSnap) * this.translationSnap;\n          }\n          if (axis.search('Y') !== -1) {\n            object.position.y = Math.round(object.position.y / this.translationSnap) * this.translationSnap;\n          }\n          if (axis.search('Z') !== -1) {\n            object.position.z = Math.round(object.position.z / this.translationSnap) * this.translationSnap;\n          }\n          if (object.parent) {\n            object.position.sub(_tempVector.setFromMatrixPosition(object.parent.matrixWorld));\n          }\n        }\n      }\n    } else if (mode === 'scale') {\n      if (axis.search('XYZ') !== -1) {\n        var d = pointEnd.length() / pointStart.length();\n        if (pointEnd.dot(pointStart) < 0) d *= -1;\n        _tempVector2.set(d, d, d);\n      } else {\n        _tempVector.copy(pointStart);\n        _tempVector2.copy(pointEnd);\n        _tempVector.applyQuaternion(worldQuaternionInv);\n        _tempVector2.applyQuaternion(worldQuaternionInv);\n        _tempVector2.divide(_tempVector);\n        if (axis.search('X') === -1) {\n          _tempVector2.x = 1;\n        }\n        if (axis.search('Y') === -1) {\n          _tempVector2.y = 1;\n        }\n        if (axis.search('Z') === -1) {\n          _tempVector2.z = 1;\n        }\n      }\n\n      // Apply scale\n\n      object.scale.copy(scaleStart).multiply(_tempVector2);\n      if (this.scaleSnap) {\n        if (axis.search('X') !== -1) {\n          object.scale.x = Math.round(object.scale.x / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n        }\n        if (axis.search('Y') !== -1) {\n          object.scale.y = Math.round(object.scale.y / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n        }\n        if (axis.search('Z') !== -1) {\n          object.scale.z = Math.round(object.scale.z / this.scaleSnap) * this.scaleSnap || this.scaleSnap;\n        }\n      }\n    } else if (mode === 'rotate') {\n      offset.copy(pointEnd).sub(pointStart);\n      var ROTATION_SPEED = 20 / worldPosition.distanceTo(_tempVector.setFromMatrixPosition(this.camera.matrixWorld));\n      if (axis === 'E') {\n        rotationAxis.copy(eye);\n        rotationAngle = pointEnd.angleTo(pointStart);\n        startNorm.copy(pointStart).normalize();\n        endNorm.copy(pointEnd).normalize();\n        rotationAngle *= endNorm.cross(startNorm).dot(eye) < 0 ? 1 : -1;\n      } else if (axis === 'XYZE') {\n        rotationAxis.copy(offset).cross(eye).normalize();\n        rotationAngle = offset.dot(_tempVector.copy(rotationAxis).cross(this.eye)) * ROTATION_SPEED;\n      } else if (axis === 'X' || axis === 'Y' || axis === 'Z') {\n        rotationAxis.copy(_unit[axis]);\n        _tempVector.copy(_unit[axis]);\n        if (space === 'local') {\n          _tempVector.applyQuaternion(worldQuaternion);\n        }\n        rotationAngle = offset.dot(_tempVector.cross(eye).normalize()) * ROTATION_SPEED;\n      }\n\n      // Apply rotation snap\n\n      if (this.rotationSnap) rotationAngle = Math.round(rotationAngle / this.rotationSnap) * this.rotationSnap;\n      this.rotationAngle = rotationAngle;\n\n      // Apply rotate\n      if (space === 'local' && axis !== 'E' && axis !== 'XYZE') {\n        object.quaternion.copy(quaternionStart);\n        object.quaternion.multiply(_tempQuaternion.setFromAxisAngle(rotationAxis, rotationAngle)).normalize();\n      } else {\n        rotationAxis.applyQuaternion(parentQuaternionInv);\n        object.quaternion.copy(_tempQuaternion.setFromAxisAngle(rotationAxis, rotationAngle));\n        object.quaternion.multiply(quaternionStart).normalize();\n      }\n    }\n    this.dispatchEvent(changeEvent);\n    this.dispatchEvent(objectChangeEvent);\n  };\n  this.pointerUp = function (pointer) {\n    if (pointer.button !== undefined && pointer.button !== 0) return;\n    if (this.dragging && this.axis !== null) {\n      mouseUpEvent.mode = this.mode;\n      this.dispatchEvent(mouseUpEvent);\n    }\n    this.dragging = false;\n    if (pointer.button === undefined) this.axis = null;\n  };\n\n  // normalize mouse / touch pointer and remap {x,y} to view space.\n\n  function getPointer(event) {\n    if (document.pointerLockElement) {\n      return {\n        x: 0,\n        y: 0,\n        button: event.button\n      };\n    } else {\n      var pointer = event.changedTouches ? event.changedTouches[0] : event;\n      var rect = domElement.getBoundingClientRect();\n      return {\n        x: (pointer.clientX - rect.left) / rect.width * 2 - 1,\n        y: -(pointer.clientY - rect.top) / rect.height * 2 + 1,\n        button: event.button\n      };\n    }\n  }\n\n  // mouse / touch event handlers\n\n  function onPointerHover(event) {\n    if (!scope.enabled) return;\n    scope.pointerHover(getPointer(event));\n  }\n  function onPointerDown(event) {\n    if (!scope.enabled) return;\n    document.addEventListener(\"mousemove\", onPointerMove, false);\n    scope.pointerHover(getPointer(event));\n    scope.pointerDown(getPointer(event));\n  }\n  function onPointerMove(event) {\n    if (!scope.enabled) return;\n    scope.pointerMove(getPointer(event));\n  }\n  function onPointerUp(event) {\n    if (!scope.enabled) return;\n    document.removeEventListener(\"mousemove\", onPointerMove, false);\n    scope.pointerUp(getPointer(event));\n  }\n\n  // TODO: deprecate\n\n  this.getMode = function () {\n    return scope.mode;\n  };\n  this.setMode = function (mode) {\n    scope.mode = mode;\n  };\n  this.setTranslationSnap = function (translationSnap) {\n    scope.translationSnap = translationSnap;\n  };\n  this.setRotationSnap = function (rotationSnap) {\n    scope.rotationSnap = rotationSnap;\n  };\n  this.setScaleSnap = function (scaleSnap) {\n    scope.scaleSnap = scaleSnap;\n  };\n  this.setSize = function (size) {\n    scope.size = size;\n  };\n  this.setSpace = function (space) {\n    scope.space = space;\n  };\n  this.update = function () {\n    console.warn('THREE.TransformControls: update function has no more functionality and therefore has been deprecated.');\n  };\n};\nTransformControls.prototype = Object.assign(Object.create(Object3D.prototype), {\n  constructor: TransformControls,\n  isTransformControls: true\n});\nvar TransformControlsGizmo = function TransformControlsGizmo() {\n  'use strict';\n\n  Object3D.call(this);\n  this.type = 'TransformControlsGizmo';\n\n  // shared materials\n\n  var gizmoMaterial = new MeshBasicMaterial({\n    depthTest: false,\n    depthWrite: false,\n    transparent: true,\n    side: DoubleSide,\n    fog: false\n  });\n  var gizmoLineMaterial = new LineBasicMaterial({\n    depthTest: false,\n    depthWrite: false,\n    transparent: true,\n    linewidth: 1,\n    fog: false\n  });\n\n  // Make unique material for each axis/color\n\n  var matInvisible = gizmoMaterial.clone();\n  matInvisible.opacity = 0.15;\n  var matHelper = gizmoMaterial.clone();\n  matHelper.opacity = 0.33;\n  var matRed = gizmoMaterial.clone();\n  matRed.color.set(0xff0000);\n  var matGreen = gizmoMaterial.clone();\n  matGreen.color.set(0x00ff00);\n  var matBlue = gizmoMaterial.clone();\n  matBlue.color.set(0x0000ff);\n  var matWhiteTransparent = gizmoMaterial.clone();\n  matWhiteTransparent.opacity = 0.25;\n  var matYellowTransparent = matWhiteTransparent.clone();\n  matYellowTransparent.color.set(0xffff00);\n  var matCyanTransparent = matWhiteTransparent.clone();\n  matCyanTransparent.color.set(0x00ffff);\n  var matMagentaTransparent = matWhiteTransparent.clone();\n  matMagentaTransparent.color.set(0xff00ff);\n  var matYellow = gizmoMaterial.clone();\n  matYellow.color.set(0xffff00);\n  var matLineRed = gizmoLineMaterial.clone();\n  matLineRed.color.set(0xff0000);\n  var matLineGreen = gizmoLineMaterial.clone();\n  matLineGreen.color.set(0x00ff00);\n  var matLineBlue = gizmoLineMaterial.clone();\n  matLineBlue.color.set(0x0000ff);\n  var matLineCyan = gizmoLineMaterial.clone();\n  matLineCyan.color.set(0x00ffff);\n  var matLineMagenta = gizmoLineMaterial.clone();\n  matLineMagenta.color.set(0xff00ff);\n  var matLineYellow = gizmoLineMaterial.clone();\n  matLineYellow.color.set(0xffff00);\n  var matLineGray = gizmoLineMaterial.clone();\n  matLineGray.color.set(0x787878);\n  var matLineYellowTransparent = matLineYellow.clone();\n  matLineYellowTransparent.opacity = 0.25;\n\n  // reusable geometry\n\n  var arrowGeometry = new CylinderBufferGeometry(0, 0.05, 0.2, 12, 1, false);\n  var scaleHandleGeometry = new BoxBufferGeometry(0.125, 0.125, 0.125);\n  var lineGeometry = new BufferGeometry();\n  lineGeometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 0, 0], 3));\n  var CircleGeometry = function CircleGeometry(radius, arc) {\n    var geometry = new BufferGeometry();\n    var vertices = [];\n    for (var i = 0; i <= 64 * arc; ++i) {\n      vertices.push(0, Math.cos(i / 32 * Math.PI) * radius, Math.sin(i / 32 * Math.PI) * radius);\n    }\n    geometry.setAttribute('position', new Float32BufferAttribute(vertices, 3));\n    return geometry;\n  };\n\n  // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n  var TranslateHelperGeometry = function TranslateHelperGeometry() {\n    var geometry = new BufferGeometry();\n    geometry.setAttribute('position', new Float32BufferAttribute([0, 0, 0, 1, 1, 1], 3));\n    return geometry;\n  };\n\n  // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n  var gizmoTranslate = {\n    X: [[new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, -Math.PI / 2], null, 'fwd'], [new Mesh(arrowGeometry, matRed), [1, 0, 0], [0, 0, Math.PI / 2], null, 'bwd'], [new Line(lineGeometry, matLineRed)]],\n    Y: [[new Mesh(arrowGeometry, matGreen), [0, 1, 0], null, null, 'fwd'], [new Mesh(arrowGeometry, matGreen), [0, 1, 0], [Math.PI, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2]]],\n    Z: [[new Mesh(arrowGeometry, matBlue), [0, 0, 1], [Math.PI / 2, 0, 0], null, 'fwd'], [new Mesh(arrowGeometry, matBlue), [0, 0, 1], [-Math.PI / 2, 0, 0], null, 'bwd'], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0]]],\n    XYZ: [[new Mesh(new OctahedronBufferGeometry(0.1, 0), matWhiteTransparent.clone()), [0, 0, 0], [0, 0, 0]]],\n    XY: [[new Mesh(new PlaneBufferGeometry(0.295, 0.295), matYellowTransparent.clone()), [0.15, 0.15, 0]], [new Line(lineGeometry, matLineYellow), [0.18, 0.3, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.3, 0.18, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\n    YZ: [[new Mesh(new PlaneBufferGeometry(0.295, 0.295), matCyanTransparent.clone()), [0, 0.15, 0.15], [0, Math.PI / 2, 0]], [new Line(lineGeometry, matLineCyan), [0, 0.18, 0.3], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.3, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n    XZ: [[new Mesh(new PlaneBufferGeometry(0.295, 0.295), matMagentaTransparent.clone()), [0.15, 0, 0.15], [-Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineMagenta), [0.18, 0, 0.3], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.3, 0, 0.18], [0, -Math.PI / 2, 0], [0.125, 1, 1]]]\n  };\n  var pickerTranslate = {\n    X: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0.6, 0, 0], [0, 0, -Math.PI / 2]]],\n    Y: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0.6, 0]]],\n    Z: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 1, 4, 1, false), matInvisible), [0, 0, 0.6], [Math.PI / 2, 0, 0]]],\n    XYZ: [[new Mesh(new OctahedronBufferGeometry(0.2, 0), matInvisible)]],\n    XY: [[new Mesh(new PlaneBufferGeometry(0.4, 0.4), matInvisible), [0.2, 0.2, 0]]],\n    YZ: [[new Mesh(new PlaneBufferGeometry(0.4, 0.4), matInvisible), [0, 0.2, 0.2], [0, Math.PI / 2, 0]]],\n    XZ: [[new Mesh(new PlaneBufferGeometry(0.4, 0.4), matInvisible), [0.2, 0, 0.2], [-Math.PI / 2, 0, 0]]]\n  };\n  var helperTranslate = {\n    START: [[new Mesh(new OctahedronBufferGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\n    END: [[new Mesh(new OctahedronBufferGeometry(0.01, 2), matHelper), null, null, null, 'helper']],\n    DELTA: [[new Line(TranslateHelperGeometry(), matHelper), null, null, null, 'helper']],\n    X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\n    Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\n    Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\n  };\n  var gizmoRotate = {\n    X: [[new Line(CircleGeometry(1, 0.5), matLineRed)], [new Mesh(new OctahedronBufferGeometry(0.04, 0), matRed), [0, 0, 0.99], null, [1, 3, 1]]],\n    Y: [[new Line(CircleGeometry(1, 0.5), matLineGreen), null, [0, 0, -Math.PI / 2]], [new Mesh(new OctahedronBufferGeometry(0.04, 0), matGreen), [0, 0, 0.99], null, [3, 1, 1]]],\n    Z: [[new Line(CircleGeometry(1, 0.5), matLineBlue), null, [0, Math.PI / 2, 0]], [new Mesh(new OctahedronBufferGeometry(0.04, 0), matBlue), [0.99, 0, 0], null, [1, 3, 1]]],\n    E: [[new Line(CircleGeometry(1.25, 1), matLineYellowTransparent), null, [0, Math.PI / 2, 0]], [new Mesh(new CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [1.17, 0, 0], [0, 0, -Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [-1.17, 0, 0], [0, 0, Math.PI / 2], [1, 1, 0.001]], [new Mesh(new CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, -1.17, 0], [Math.PI, 0, 0], [1, 1, 0.001]], [new Mesh(new CylinderBufferGeometry(0.03, 0, 0.15, 4, 1, false), matLineYellowTransparent), [0, 1.17, 0], [0, 0, 0], [1, 1, 0.001]]],\n    XYZE: [[new Line(CircleGeometry(1, 1), matLineGray), null, [0, Math.PI / 2, 0]]]\n  };\n  var helperRotate = {\n    AXIS: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']]\n  };\n  var pickerRotate = {\n    X: [[new Mesh(new TorusBufferGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, -Math.PI / 2, -Math.PI / 2]]],\n    Y: [[new Mesh(new TorusBufferGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [Math.PI / 2, 0, 0]]],\n    Z: [[new Mesh(new TorusBufferGeometry(1, 0.1, 4, 24), matInvisible), [0, 0, 0], [0, 0, -Math.PI / 2]]],\n    E: [[new Mesh(new TorusBufferGeometry(1.25, 0.1, 2, 24), matInvisible)]],\n    XYZE: [[new Mesh(new SphereBufferGeometry(0.7, 10, 8), matInvisible)]]\n  };\n  var gizmoScale = {\n    X: [[new Mesh(scaleHandleGeometry, matRed), [0.8, 0, 0], [0, 0, -Math.PI / 2]], [new Line(lineGeometry, matLineRed), null, null, [0.8, 1, 1]]],\n    Y: [[new Mesh(scaleHandleGeometry, matGreen), [0, 0.8, 0]], [new Line(lineGeometry, matLineGreen), null, [0, 0, Math.PI / 2], [0.8, 1, 1]]],\n    Z: [[new Mesh(scaleHandleGeometry, matBlue), [0, 0, 0.8], [Math.PI / 2, 0, 0]], [new Line(lineGeometry, matLineBlue), null, [0, -Math.PI / 2, 0], [0.8, 1, 1]]],\n    XY: [[new Mesh(scaleHandleGeometry, matYellowTransparent), [0.85, 0.85, 0], null, [2, 2, 0.2]], [new Line(lineGeometry, matLineYellow), [0.855, 0.98, 0], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineYellow), [0.98, 0.855, 0], [0, 0, Math.PI / 2], [0.125, 1, 1]]],\n    YZ: [[new Mesh(scaleHandleGeometry, matCyanTransparent), [0, 0.85, 0.85], null, [0.2, 2, 2]], [new Line(lineGeometry, matLineCyan), [0, 0.855, 0.98], [0, 0, Math.PI / 2], [0.125, 1, 1]], [new Line(lineGeometry, matLineCyan), [0, 0.98, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n    XZ: [[new Mesh(scaleHandleGeometry, matMagentaTransparent), [0.85, 0, 0.85], null, [2, 0.2, 2]], [new Line(lineGeometry, matLineMagenta), [0.855, 0, 0.98], null, [0.125, 1, 1]], [new Line(lineGeometry, matLineMagenta), [0.98, 0, 0.855], [0, -Math.PI / 2, 0], [0.125, 1, 1]]],\n    XYZX: [[new Mesh(new BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [1.1, 0, 0]]],\n    XYZY: [[new Mesh(new BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 1.1, 0]]],\n    XYZZ: [[new Mesh(new BoxBufferGeometry(0.125, 0.125, 0.125), matWhiteTransparent.clone()), [0, 0, 1.1]]]\n  };\n  var pickerScale = {\n    X: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0.5, 0, 0], [0, 0, -Math.PI / 2]]],\n    Y: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0.5, 0]]],\n    Z: [[new Mesh(new CylinderBufferGeometry(0.2, 0, 0.8, 4, 1, false), matInvisible), [0, 0, 0.5], [Math.PI / 2, 0, 0]]],\n    XY: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0.85, 0], null, [3, 3, 0.2]]],\n    YZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0, 0.85, 0.85], null, [0.2, 3, 3]]],\n    XZ: [[new Mesh(scaleHandleGeometry, matInvisible), [0.85, 0, 0.85], null, [3, 0.2, 3]]],\n    XYZX: [[new Mesh(new BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible), [1.1, 0, 0]]],\n    XYZY: [[new Mesh(new BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible), [0, 1.1, 0]]],\n    XYZZ: [[new Mesh(new BoxBufferGeometry(0.2, 0.2, 0.2), matInvisible), [0, 0, 1.1]]]\n  };\n  var helperScale = {\n    X: [[new Line(lineGeometry, matHelper.clone()), [-1e3, 0, 0], null, [1e6, 1, 1], 'helper']],\n    Y: [[new Line(lineGeometry, matHelper.clone()), [0, -1e3, 0], [0, 0, Math.PI / 2], [1e6, 1, 1], 'helper']],\n    Z: [[new Line(lineGeometry, matHelper.clone()), [0, 0, -1e3], [0, -Math.PI / 2, 0], [1e6, 1, 1], 'helper']]\n  };\n\n  // Creates an Object3D with gizmos described in custom hierarchy definition.\n\n  var setupGizmo = function setupGizmo(gizmoMap) {\n    var gizmo = new Object3D();\n    for (var name in gizmoMap) {\n      for (var i = gizmoMap[name].length; i--;) {\n        var object = gizmoMap[name][i][0].clone();\n        var position = gizmoMap[name][i][1];\n        var rotation = gizmoMap[name][i][2];\n        var scale = gizmoMap[name][i][3];\n        var tag = gizmoMap[name][i][4];\n\n        // name and tag properties are essential for picking and updating logic.\n        object.name = name;\n        object.tag = tag;\n        if (position) {\n          object.position.set(position[0], position[1], position[2]);\n        }\n        if (rotation) {\n          object.rotation.set(rotation[0], rotation[1], rotation[2]);\n        }\n        if (scale) {\n          object.scale.set(scale[0], scale[1], scale[2]);\n        }\n        object.updateMatrix();\n        var tempGeometry = object.geometry.clone();\n        tempGeometry.applyMatrix4(object.matrix);\n        object.geometry = tempGeometry;\n        object.renderOrder = Infinity;\n        object.position.set(0, 0, 0);\n        object.rotation.set(0, 0, 0);\n        object.scale.set(1, 1, 1);\n        gizmo.add(object);\n      }\n    }\n    return gizmo;\n  };\n\n  // Reusable utility variables\n\n  var tempVector = new Vector3(0, 0, 0);\n  var tempEuler = new Euler();\n  var alignVector = new Vector3(0, 1, 0);\n  var zeroVector = new Vector3(0, 0, 0);\n  var lookAtMatrix = new Matrix4();\n  var tempQuaternion = new Quaternion();\n  var tempQuaternion2 = new Quaternion();\n  var identityQuaternion = new Quaternion();\n  var unitX = new Vector3(1, 0, 0);\n  var unitY = new Vector3(0, 1, 0);\n  var unitZ = new Vector3(0, 0, 1);\n\n  // Gizmo creation\n\n  this.gizmo = {};\n  this.picker = {};\n  this.helper = {};\n  this.add(this.gizmo[\"translate\"] = setupGizmo(gizmoTranslate));\n  this.add(this.gizmo[\"rotate\"] = setupGizmo(gizmoRotate));\n  this.add(this.gizmo[\"scale\"] = setupGizmo(gizmoScale));\n  this.add(this.picker[\"translate\"] = setupGizmo(pickerTranslate));\n  this.add(this.picker[\"rotate\"] = setupGizmo(pickerRotate));\n  this.add(this.picker[\"scale\"] = setupGizmo(pickerScale));\n  this.add(this.helper[\"translate\"] = setupGizmo(helperTranslate));\n  this.add(this.helper[\"rotate\"] = setupGizmo(helperRotate));\n  this.add(this.helper[\"scale\"] = setupGizmo(helperScale));\n\n  // Pickers should be hidden always\n\n  this.picker[\"translate\"].visible = false;\n  this.picker[\"rotate\"].visible = false;\n  this.picker[\"scale\"].visible = false;\n\n  // updateMatrixWorld will update transformations and appearance of individual handles\n\n  this.updateMatrixWorld = function () {\n    var space = this.space;\n    if (this.mode === 'scale') space = 'local'; // scale always oriented to local rotation\n\n    var quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n    // Show only gizmos for current transform mode\n\n    this.gizmo[\"translate\"].visible = this.mode === \"translate\";\n    this.gizmo[\"rotate\"].visible = this.mode === \"rotate\";\n    this.gizmo[\"scale\"].visible = this.mode === \"scale\";\n    this.helper[\"translate\"].visible = this.mode === \"translate\";\n    this.helper[\"rotate\"].visible = this.mode === \"rotate\";\n    this.helper[\"scale\"].visible = this.mode === \"scale\";\n    var handles = [];\n    handles = handles.concat(this.picker[this.mode].children);\n    handles = handles.concat(this.gizmo[this.mode].children);\n    handles = handles.concat(this.helper[this.mode].children);\n    for (var i = 0; i < handles.length; i++) {\n      var handle = handles[i];\n\n      // hide aligned to camera\n\n      handle.visible = true;\n      handle.rotation.set(0, 0, 0);\n      handle.position.copy(this.worldPosition);\n      var factor;\n      if (this.camera.isOrthographicCamera) {\n        factor = (this.camera.top - this.camera.bottom) / this.camera.zoom;\n      } else {\n        factor = this.worldPosition.distanceTo(this.cameraPosition) * Math.min(1.9 * Math.tan(Math.PI * this.camera.fov / 360) / this.camera.zoom, 7);\n      }\n      handle.scale.set(1, 1, 1).multiplyScalar(factor * this.size / 7);\n\n      // TODO: simplify helpers and consider decoupling from gizmo\n\n      if (handle.tag === 'helper') {\n        handle.visible = false;\n        if (handle.name === 'AXIS') {\n          handle.position.copy(this.worldPositionStart);\n          handle.visible = !!this.axis;\n          if (this.axis === 'X') {\n            tempQuaternion.setFromEuler(tempEuler.set(0, 0, 0));\n            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\n            if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n              handle.visible = false;\n            }\n          }\n          if (this.axis === 'Y') {\n            tempQuaternion.setFromEuler(tempEuler.set(0, 0, Math.PI / 2));\n            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\n            if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n              handle.visible = false;\n            }\n          }\n          if (this.axis === 'Z') {\n            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));\n            handle.quaternion.copy(quaternion).multiply(tempQuaternion);\n            if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > 0.9) {\n              handle.visible = false;\n            }\n          }\n          if (this.axis === 'XYZE') {\n            tempQuaternion.setFromEuler(tempEuler.set(0, Math.PI / 2, 0));\n            alignVector.copy(this.rotationAxis);\n            handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(zeroVector, alignVector, unitY));\n            handle.quaternion.multiply(tempQuaternion);\n            handle.visible = this.dragging;\n          }\n          if (this.axis === 'E') {\n            handle.visible = false;\n          }\n        } else if (handle.name === 'START') {\n          handle.position.copy(this.worldPositionStart);\n          handle.visible = this.dragging;\n        } else if (handle.name === 'END') {\n          handle.position.copy(this.worldPosition);\n          handle.visible = this.dragging;\n        } else if (handle.name === 'DELTA') {\n          handle.position.copy(this.worldPositionStart);\n          handle.quaternion.copy(this.worldQuaternionStart);\n          tempVector.set(1e-10, 1e-10, 1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1);\n          tempVector.applyQuaternion(this.worldQuaternionStart.clone().inverse());\n          handle.scale.copy(tempVector);\n          handle.visible = this.dragging;\n        } else {\n          handle.quaternion.copy(quaternion);\n          if (this.dragging) {\n            handle.position.copy(this.worldPositionStart);\n          } else {\n            handle.position.copy(this.worldPosition);\n          }\n          if (this.axis) {\n            handle.visible = this.axis.search(handle.name) !== -1;\n          }\n        }\n\n        // If updating helper, skip rest of the loop\n        continue;\n      }\n\n      // Align handles to current local or world rotation\n\n      handle.quaternion.copy(quaternion);\n      if (this.mode === 'translate' || this.mode === 'scale') {\n        // Hide translate and scale axis facing the camera\n\n        var AXIS_HIDE_TRESHOLD = 0.99;\n        var PLANE_HIDE_TRESHOLD = 0.2;\n        var AXIS_FLIP_TRESHOLD = 0.0;\n        if (handle.name === 'X' || handle.name === 'XYZX') {\n          if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n        if (handle.name === 'Y' || handle.name === 'XYZY') {\n          if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n        if (handle.name === 'Z' || handle.name === 'XYZZ') {\n          if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) > AXIS_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n        if (handle.name === 'XY') {\n          if (Math.abs(alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n        if (handle.name === 'YZ') {\n          if (Math.abs(alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n        if (handle.name === 'XZ') {\n          if (Math.abs(alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye)) < PLANE_HIDE_TRESHOLD) {\n            handle.scale.set(1e-10, 1e-10, 1e-10);\n            handle.visible = false;\n          }\n        }\n\n        // Flip translate and scale axis ocluded behind another axis\n\n        if (handle.name.search('X') !== -1) {\n          if (alignVector.copy(unitX).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n            if (handle.tag === 'fwd') {\n              handle.visible = false;\n            } else {\n              handle.scale.x *= -1;\n            }\n          } else if (handle.tag === 'bwd') {\n            handle.visible = false;\n          }\n        }\n        if (handle.name.search('Y') !== -1) {\n          if (alignVector.copy(unitY).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n            if (handle.tag === 'fwd') {\n              handle.visible = false;\n            } else {\n              handle.scale.y *= -1;\n            }\n          } else if (handle.tag === 'bwd') {\n            handle.visible = false;\n          }\n        }\n        if (handle.name.search('Z') !== -1) {\n          if (alignVector.copy(unitZ).applyQuaternion(quaternion).dot(this.eye) < AXIS_FLIP_TRESHOLD) {\n            if (handle.tag === 'fwd') {\n              handle.visible = false;\n            } else {\n              handle.scale.z *= -1;\n            }\n          } else if (handle.tag === 'bwd') {\n            handle.visible = false;\n          }\n        }\n      } else if (this.mode === 'rotate') {\n        // Align handles to current local or world rotation\n\n        tempQuaternion2.copy(quaternion);\n        alignVector.copy(this.eye).applyQuaternion(tempQuaternion.copy(quaternion).inverse());\n        if (handle.name.search(\"E\") !== -1) {\n          handle.quaternion.setFromRotationMatrix(lookAtMatrix.lookAt(this.eye, zeroVector, unitY));\n        }\n        if (handle.name === 'X') {\n          tempQuaternion.setFromAxisAngle(unitX, Math.atan2(-alignVector.y, alignVector.z));\n          tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\n          handle.quaternion.copy(tempQuaternion);\n        }\n        if (handle.name === 'Y') {\n          tempQuaternion.setFromAxisAngle(unitY, Math.atan2(alignVector.x, alignVector.z));\n          tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\n          handle.quaternion.copy(tempQuaternion);\n        }\n        if (handle.name === 'Z') {\n          tempQuaternion.setFromAxisAngle(unitZ, Math.atan2(alignVector.y, alignVector.x));\n          tempQuaternion.multiplyQuaternions(tempQuaternion2, tempQuaternion);\n          handle.quaternion.copy(tempQuaternion);\n        }\n      }\n\n      // Hide disabled axes\n      handle.visible = handle.visible && (handle.name.indexOf(\"X\") === -1 || this.showX);\n      handle.visible = handle.visible && (handle.name.indexOf(\"Y\") === -1 || this.showY);\n      handle.visible = handle.visible && (handle.name.indexOf(\"Z\") === -1 || this.showZ);\n      handle.visible = handle.visible && (handle.name.indexOf(\"E\") === -1 || this.showX && this.showY && this.showZ);\n\n      // highlight selected axis\n\n      handle.material._opacity = handle.material._opacity || handle.material.opacity;\n      handle.material._color = handle.material._color || handle.material.color.clone();\n      handle.material.color.copy(handle.material._color);\n      handle.material.opacity = handle.material._opacity;\n      if (!this.enabled) {\n        handle.material.opacity *= 0.5;\n        handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n      } else if (this.axis) {\n        if (handle.name === this.axis) {\n          handle.material.opacity = 1.0;\n          handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n        } else if (this.axis.split('').some(function (a) {\n          return handle.name === a;\n        })) {\n          handle.material.opacity = 1.0;\n          handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n        } else {\n          handle.material.opacity *= 0.25;\n          handle.material.color.lerp(new Color(1, 1, 1), 0.5);\n        }\n      }\n    }\n    Object3D.prototype.updateMatrixWorld.call(this);\n  };\n};\nTransformControlsGizmo.prototype = Object.assign(Object.create(Object3D.prototype), {\n  constructor: TransformControlsGizmo,\n  isTransformControlsGizmo: true\n});\nvar TransformControlsPlane = function TransformControlsPlane() {\n  'use strict';\n\n  Mesh.call(this, new PlaneBufferGeometry(100000, 100000, 2, 2), new MeshBasicMaterial({\n    visible: false,\n    wireframe: true,\n    side: DoubleSide,\n    transparent: true,\n    opacity: 0.1\n  }));\n  this.type = 'TransformControlsPlane';\n  var unitX = new Vector3(1, 0, 0);\n  var unitY = new Vector3(0, 1, 0);\n  var unitZ = new Vector3(0, 0, 1);\n  var tempVector = new Vector3();\n  var dirVector = new Vector3();\n  var alignVector = new Vector3();\n  var tempMatrix = new Matrix4();\n  var identityQuaternion = new Quaternion();\n  this.updateMatrixWorld = function () {\n    var space = this.space;\n    this.position.copy(this.worldPosition);\n    if (this.mode === 'scale') space = 'local'; // scale always oriented to local rotation\n\n    unitX.set(1, 0, 0).applyQuaternion(space === \"local\" ? this.worldQuaternion : identityQuaternion);\n    unitY.set(0, 1, 0).applyQuaternion(space === \"local\" ? this.worldQuaternion : identityQuaternion);\n    unitZ.set(0, 0, 1).applyQuaternion(space === \"local\" ? this.worldQuaternion : identityQuaternion);\n\n    // Align the plane for current transform mode, axis and space.\n\n    alignVector.copy(unitY);\n    switch (this.mode) {\n      case 'translate':\n      case 'scale':\n        switch (this.axis) {\n          case 'X':\n            alignVector.copy(this.eye).cross(unitX);\n            dirVector.copy(unitX).cross(alignVector);\n            break;\n          case 'Y':\n            alignVector.copy(this.eye).cross(unitY);\n            dirVector.copy(unitY).cross(alignVector);\n            break;\n          case 'Z':\n            alignVector.copy(this.eye).cross(unitZ);\n            dirVector.copy(unitZ).cross(alignVector);\n            break;\n          case 'XY':\n            dirVector.copy(unitZ);\n            break;\n          case 'YZ':\n            dirVector.copy(unitX);\n            break;\n          case 'XZ':\n            alignVector.copy(unitZ);\n            dirVector.copy(unitY);\n            break;\n          case 'XYZ':\n          case 'E':\n            dirVector.set(0, 0, 0);\n            break;\n        }\n        break;\n      case 'rotate':\n      default:\n        // special case for rotate\n        dirVector.set(0, 0, 0);\n    }\n    if (dirVector.length() === 0) {\n      // If in rotate mode, make the plane parallel to camera\n      this.quaternion.copy(this.cameraQuaternion);\n    } else {\n      tempMatrix.lookAt(tempVector.set(0, 0, 0), dirVector, alignVector);\n      this.quaternion.setFromRotationMatrix(tempMatrix);\n    }\n    Object3D.prototype.updateMatrixWorld.call(this);\n  };\n};\nTransformControlsPlane.prototype = Object.assign(Object.create(Mesh.prototype), {\n  constructor: TransformControlsPlane,\n  isTransformControlsPlane: true\n});\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };","map":{"version":3,"names":["BoxBufferGeometry","BufferGeometry","Color","CylinderBufferGeometry","DoubleSide","Euler","Float32BufferAttribute","Line","LineBasicMaterial","Matrix4","Mesh","MeshBasicMaterial","Object3D","OctahedronBufferGeometry","PlaneBufferGeometry","Quaternion","Raycaster","SphereBufferGeometry","TorusBufferGeometry","Vector3","TransformControls","camera","domElement","undefined","console","warn","document","call","visible","_gizmo","TransformControlsGizmo","add","_plane","TransformControlsPlane","scope","defineProperty","changeEvent","type","mouseDownEvent","mouseUpEvent","mode","objectChangeEvent","raycaster","intersectObjectWithRay","object","includeInvisible","allIntersections","intersectObject","i","length","_tempVector","_tempVector2","_tempQuaternion","_unit","X","Y","Z","pointStart","pointEnd","offset","rotationAxis","startNorm","endNorm","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentQuaternionInv","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldQuaternionInv","worldScale","eye","positionStart","quaternionStart","scaleStart","addEventListener","onPointerDown","onPointerHover","onPointerMove","onPointerUp","dispose","removeEventListener","traverse","child","geometry","material","attach","detach","axis","propName","defaultValue","propValue","Object","get","set","value","dispatchEvent","updateMatrixWorld","parent","error","matrixWorld","decompose","copy","inverse","sub","normalize","prototype","pointerHover","pointer","dragging","button","setFromCamera","intersect","picker","name","pointerDown","planeIntersect","space","snap","rotationSnap","rotation","x","Math","round","y","z","position","quaternion","scale","point","pointerMove","applyQuaternion","indexOf","divide","translationSnap","search","setFromMatrixPosition","d","dot","multiply","scaleSnap","ROTATION_SPEED","distanceTo","angleTo","cross","setFromAxisAngle","pointerUp","getPointer","event","pointerLockElement","changedTouches","rect","getBoundingClientRect","clientX","left","width","clientY","top","height","enabled","getMode","setMode","setTranslationSnap","setRotationSnap","setScaleSnap","setSize","size","setSpace","update","assign","create","constructor","isTransformControls","gizmoMaterial","depthTest","depthWrite","transparent","side","fog","gizmoLineMaterial","linewidth","matInvisible","clone","opacity","matHelper","matRed","color","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matYellow","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","scaleHandleGeometry","lineGeometry","setAttribute","CircleGeometry","radius","arc","vertices","push","cos","PI","sin","TranslateHelperGeometry","gizmoTranslate","XYZ","XY","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","tempVector","tempEuler","alignVector","zeroVector","lookAtMatrix","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","concat","children","handle","factor","isOrthographicCamera","bottom","zoom","min","tan","fov","multiplyScalar","setFromEuler","abs","setFromRotationMatrix","lookAt","AXIS_HIDE_TRESHOLD","PLANE_HIDE_TRESHOLD","AXIS_FLIP_TRESHOLD","atan2","multiplyQuaternions","showX","showY","showZ","_opacity","_color","lerp","split","some","a","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane"],"sources":["/Users/mac/Desktop/react-3js-word-sphere/node_modules/three/examples/jsm/controls/TransformControls.js"],"sourcesContent":["/**\n * @author arodic / https://github.com/arodic\n */\n\nimport {\n\tBoxBufferGeometry,\n\tBufferGeometry,\n\tColor,\n\tCylinderBufferGeometry,\n\tDoubleSide,\n\tEuler,\n\tFloat32BufferAttribute,\n\tLine,\n\tLineBasicMaterial,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tObject3D,\n\tOctahedronBufferGeometry,\n\tPlaneBufferGeometry,\n\tQuaternion,\n\tRaycaster,\n\tSphereBufferGeometry,\n\tTorusBufferGeometry,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar TransformControls = function ( camera, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document;\n\n\t}\n\n\tObject3D.call( this );\n\n\tthis.visible = false;\n\tthis.domElement = domElement;\n\n\tvar _gizmo = new TransformControlsGizmo();\n\tthis.add( _gizmo );\n\n\tvar _plane = new TransformControlsPlane();\n\tthis.add( _plane );\n\n\tvar scope = this;\n\n\t// Define properties with getters/setter\n\t// Setting the defined property will automatically trigger change event\n\t// Defined properties are passed down to gizmo and plane\n\n\tdefineProperty( \"camera\", camera );\n\tdefineProperty( \"object\", undefined );\n\tdefineProperty( \"enabled\", true );\n\tdefineProperty( \"axis\", null );\n\tdefineProperty( \"mode\", \"translate\" );\n\tdefineProperty( \"translationSnap\", null );\n\tdefineProperty( \"rotationSnap\", null );\n\tdefineProperty( \"scaleSnap\", null );\n\tdefineProperty( \"space\", \"world\" );\n\tdefineProperty( \"size\", 1 );\n\tdefineProperty( \"dragging\", false );\n\tdefineProperty( \"showX\", true );\n\tdefineProperty( \"showY\", true );\n\tdefineProperty( \"showZ\", true );\n\n\tvar changeEvent = { type: \"change\" };\n\tvar mouseDownEvent = { type: \"mouseDown\" };\n\tvar mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n\tvar objectChangeEvent = { type: \"objectChange\" };\n\n\t// Reusable utility variables\n\n\tvar raycaster = new Raycaster();\n\n\tfunction intersectObjectWithRay( object, raycaster, includeInvisible ) {\n\n\t\tvar allIntersections = raycaster.intersectObject( object, true );\n\n\t\tfor ( var i = allIntersections.length; i --; ) {\n\n\t\t\tif ( allIntersections[ i ].object.visible || includeInvisible ) {\n\n\t\t\t\treturn allIntersections[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tvar _tempVector = new Vector3();\n\tvar _tempVector2 = new Vector3();\n\tvar _tempQuaternion = new Quaternion();\n\tvar _unit = {\n\t\tX: new Vector3( 1, 0, 0 ),\n\t\tY: new Vector3( 0, 1, 0 ),\n\t\tZ: new Vector3( 0, 0, 1 )\n\t};\n\n\tvar pointStart = new Vector3();\n\tvar pointEnd = new Vector3();\n\tvar offset = new Vector3();\n\tvar rotationAxis = new Vector3();\n\tvar startNorm = new Vector3();\n\tvar endNorm = new Vector3();\n\tvar rotationAngle = 0;\n\n\tvar cameraPosition = new Vector3();\n\tvar cameraQuaternion = new Quaternion();\n\tvar cameraScale = new Vector3();\n\n\tvar parentPosition = new Vector3();\n\tvar parentQuaternion = new Quaternion();\n\tvar parentQuaternionInv = new Quaternion();\n\tvar parentScale = new Vector3();\n\n\tvar worldPositionStart = new Vector3();\n\tvar worldQuaternionStart = new Quaternion();\n\tvar worldScaleStart = new Vector3();\n\n\tvar worldPosition = new Vector3();\n\tvar worldQuaternion = new Quaternion();\n\tvar worldQuaternionInv = new Quaternion();\n\tvar worldScale = new Vector3();\n\n\tvar eye = new Vector3();\n\n\tvar positionStart = new Vector3();\n\tvar quaternionStart = new Quaternion();\n\tvar scaleStart = new Vector3();\n\n\t// TODO: remove properties unused in plane and gizmo\n\n\tdefineProperty( \"worldPosition\", worldPosition );\n\tdefineProperty( \"worldPositionStart\", worldPositionStart );\n\tdefineProperty( \"worldQuaternion\", worldQuaternion );\n\tdefineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n\tdefineProperty( \"cameraPosition\", cameraPosition );\n\tdefineProperty( \"cameraQuaternion\", cameraQuaternion );\n\tdefineProperty( \"pointStart\", pointStart );\n\tdefineProperty( \"pointEnd\", pointEnd );\n\tdefineProperty( \"rotationAxis\", rotationAxis );\n\tdefineProperty( \"rotationAngle\", rotationAngle );\n\tdefineProperty( \"eye\", eye );\n\n\t{\n\n\t\tdomElement.addEventListener( \"mousedown\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"touchstart\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"mousemove\", onPointerHover, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerHover, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerMove, false );\n\t\tdocument.addEventListener( \"mouseup\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchend\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchcancel\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchleave\", onPointerUp, false );\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tdomElement.removeEventListener( \"mousedown\", onPointerDown );\n\t\tdomElement.removeEventListener( \"touchstart\", onPointerDown );\n\t\tdomElement.removeEventListener( \"mousemove\", onPointerHover );\n\t\tdocument.removeEventListener( \"mousemove\", onPointerMove );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerHover );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerMove );\n\t\tdocument.removeEventListener( \"mouseup\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchend\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchcancel\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchleave\", onPointerUp );\n\n\t\tthis.traverse( function ( child ) {\n\n\t\t\tif ( child.geometry ) child.geometry.dispose();\n\t\t\tif ( child.material ) child.material.dispose();\n\n\t\t} );\n\n\t};\n\n\t// Set current object\n\tthis.attach = function ( object ) {\n\n\t\tthis.object = object;\n\t\tthis.visible = true;\n\n\t\treturn this;\n\n\t};\n\n\t// Detatch from object\n\tthis.detach = function () {\n\n\t\tthis.object = undefined;\n\t\tthis.visible = false;\n\t\tthis.axis = null;\n\n\t\treturn this;\n\n\t};\n\n\t// Defined getter, setter and store for a property\n\tfunction defineProperty( propName, defaultValue ) {\n\n\t\tvar propValue = defaultValue;\n\n\t\tObject.defineProperty( scope, propName, {\n\n\t\t\tget: function () {\n\n\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tif ( propValue !== value ) {\n\n\t\t\t\t\tpropValue = value;\n\t\t\t\t\t_plane[ propName ] = value;\n\t\t\t\t\t_gizmo[ propName ] = value;\n\n\t\t\t\t\tscope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n\t\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tscope[ propName ] = defaultValue;\n\t\t_plane[ propName ] = defaultValue;\n\t\t_gizmo[ propName ] = defaultValue;\n\n\t}\n\n\t// updateMatrixWorld  updates key transformation variables\n\tthis.updateMatrixWorld = function () {\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\tif ( this.object.parent === null ) {\n\n\t\t\t\tconsole.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\n\n\t\t\t} else {\n\n\t\t\t\tthis.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n\n\t\t\t}\n\n\t\t\tthis.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n\t\t\tparentQuaternionInv.copy( parentQuaternion ).inverse();\n\t\t\tworldQuaternionInv.copy( worldQuaternion ).inverse();\n\n\t\t}\n\n\t\tthis.camera.updateMatrixWorld();\n\t\tthis.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n\t\teye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n\tthis.pointerHover = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar intersect = intersectObjectWithRay( _gizmo.picker[ this.mode ], raycaster );\n\n\t\tif ( intersect ) {\n\n\t\t\tthis.axis = intersect.object.name;\n\n\t\t} else {\n\n\t\t\tthis.axis = null;\n\n\t\t}\n\n\t};\n\n\tthis.pointerDown = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\tif ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n\t\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\t\tif ( planeIntersect ) {\n\n\t\t\t\tvar space = this.space;\n\n\t\t\t\tif ( this.mode === 'scale' ) {\n\n\t\t\t\t\tspace = 'local';\n\n\t\t\t\t} else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\n\n\t\t\t\t\tspace = 'world';\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\n\n\t\t\t\t\tvar snap = this.rotationSnap;\n\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n\t\t\t\t}\n\n\t\t\t\tthis.object.updateMatrixWorld();\n\t\t\t\tthis.object.parent.updateMatrixWorld();\n\n\t\t\t\tpositionStart.copy( this.object.position );\n\t\t\t\tquaternionStart.copy( this.object.quaternion );\n\t\t\t\tscaleStart.copy( this.object.scale );\n\n\t\t\t\tthis.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n\t\t\t\tpointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\t\t}\n\n\t\t\tthis.dragging = true;\n\t\t\tmouseDownEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseDownEvent );\n\n\t\t}\n\n\t};\n\n\tthis.pointerMove = function ( pointer ) {\n\n\t\tvar axis = this.axis;\n\t\tvar mode = this.mode;\n\t\tvar object = this.object;\n\t\tvar space = this.space;\n\n\t\tif ( mode === 'scale' ) {\n\n\t\t\tspace = 'local';\n\n\t\t} else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\n\n\t\t\tspace = 'world';\n\n\t\t}\n\n\t\tif ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\tif ( ! planeIntersect ) return;\n\n\t\tpointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\tif ( mode === 'translate' ) {\n\n\t\t\t// Apply translate\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( worldQuaternionInv );\n\n\t\t\t}\n\n\t\t\tif ( axis.indexOf( 'X' ) === - 1 ) offset.x = 0;\n\t\t\tif ( axis.indexOf( 'Y' ) === - 1 ) offset.y = 0;\n\t\t\tif ( axis.indexOf( 'Z' ) === - 1 ) offset.z = 0;\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( quaternionStart ).divide( parentScale );\n\n\t\t\t} else {\n\n\t\t\t\toffset.applyQuaternion( parentQuaternionInv ).divide( parentScale );\n\n\t\t\t}\n\n\t\t\tobject.position.copy( offset ).add( positionStart );\n\n\t\t\t// Apply translation snap\n\n\t\t\tif ( this.translationSnap ) {\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\tobject.position.applyQuaternion( _tempQuaternion.copy( quaternionStart ).inverse() );\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.position.applyQuaternion( quaternionStart );\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'world' ) {\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'scale' ) {\n\n\t\t\tif ( axis.search( 'XYZ' ) !== - 1 ) {\n\n\t\t\t\tvar d = pointEnd.length() / pointStart.length();\n\n\t\t\t\tif ( pointEnd.dot( pointStart ) < 0 ) d *= - 1;\n\n\t\t\t\t_tempVector2.set( d, d, d );\n\n\t\t\t} else {\n\n\t\t\t\t_tempVector.copy( pointStart );\n\t\t\t\t_tempVector2.copy( pointEnd );\n\n\t\t\t\t_tempVector.applyQuaternion( worldQuaternionInv );\n\t\t\t\t_tempVector2.applyQuaternion( worldQuaternionInv );\n\n\t\t\t\t_tempVector2.divide( _tempVector );\n\n\t\t\t\tif ( axis.search( 'X' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.x = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.y = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.z = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply scale\n\n\t\t\tobject.scale.copy( scaleStart ).multiply( _tempVector2 );\n\n\t\t\tif ( this.scaleSnap ) {\n\n\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'rotate' ) {\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tvar ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n\t\t\tif ( axis === 'E' ) {\n\n\t\t\t\trotationAxis.copy( eye );\n\t\t\t\trotationAngle = pointEnd.angleTo( pointStart );\n\n\t\t\t\tstartNorm.copy( pointStart ).normalize();\n\t\t\t\tendNorm.copy( pointEnd ).normalize();\n\n\t\t\t\trotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : - 1 );\n\n\t\t\t} else if ( axis === 'XYZE' ) {\n\n\t\t\t\trotationAxis.copy( offset ).cross( eye ).normalize();\n\t\t\t\trotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\n\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n\t\t\t\trotationAxis.copy( _unit[ axis ] );\n\n\t\t\t\t_tempVector.copy( _unit[ axis ] );\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\t_tempVector.applyQuaternion( worldQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\trotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n\t\t\t}\n\n\t\t\t// Apply rotation snap\n\n\t\t\tif ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n\t\t\tthis.rotationAngle = rotationAngle;\n\n\t\t\t// Apply rotate\n\t\t\tif ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\n\n\t\t\t\tobject.quaternion.copy( quaternionStart );\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\trotationAxis.applyQuaternion( parentQuaternionInv );\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\t\t\t\tobject.quaternion.multiply( quaternionStart ).normalize();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.dispatchEvent( changeEvent );\n\t\tthis.dispatchEvent( objectChangeEvent );\n\n\t};\n\n\tthis.pointerUp = function ( pointer ) {\n\n\t\tif ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\n\n\t\t\tmouseUpEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseUpEvent );\n\n\t\t}\n\n\t\tthis.dragging = false;\n\n\t\tif ( pointer.button === undefined ) this.axis = null;\n\n\t};\n\n\t// normalize mouse / touch pointer and remap {x,y} to view space.\n\n\tfunction getPointer( event ) {\n\n\t\tif ( document.pointerLockElement ) {\n\n\t\t\treturn {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n\t\t\tvar rect = domElement.getBoundingClientRect();\n\n\t\t\treturn {\n\t\t\t\tx: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n\t\t\t\ty: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// mouse / touch event handlers\n\n\tfunction onPointerHover( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.pointerHover( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tdocument.addEventListener( \"mousemove\", onPointerMove, false );\n\n\t\tscope.pointerHover( getPointer( event ) );\n\t\tscope.pointerDown( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.pointerMove( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tdocument.removeEventListener( \"mousemove\", onPointerMove, false );\n\n\t\tscope.pointerUp( getPointer( event ) );\n\n\t}\n\n\t// TODO: deprecate\n\n\tthis.getMode = function () {\n\n\t\treturn scope.mode;\n\n\t};\n\n\tthis.setMode = function ( mode ) {\n\n\t\tscope.mode = mode;\n\n\t};\n\n\tthis.setTranslationSnap = function ( translationSnap ) {\n\n\t\tscope.translationSnap = translationSnap;\n\n\t};\n\n\tthis.setRotationSnap = function ( rotationSnap ) {\n\n\t\tscope.rotationSnap = rotationSnap;\n\n\t};\n\n\tthis.setScaleSnap = function ( scaleSnap ) {\n\n\t\tscope.scaleSnap = scaleSnap;\n\n\t};\n\n\tthis.setSize = function ( size ) {\n\n\t\tscope.size = size;\n\n\t};\n\n\tthis.setSpace = function ( space ) {\n\n\t\tscope.space = space;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tconsole.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\n\n\t};\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: TransformControls,\n\n\tisTransformControls: true\n\n} );\n\n\nvar TransformControlsGizmo = function () {\n\n\t'use strict';\n\n\tObject3D.call( this );\n\n\tthis.type = 'TransformControlsGizmo';\n\n\t// shared materials\n\n\tvar gizmoMaterial = new MeshBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tside: DoubleSide,\n\t\tfog: false\n\t} );\n\n\tvar gizmoLineMaterial = new LineBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tlinewidth: 1,\n\t\tfog: false\n\t} );\n\n\t// Make unique material for each axis/color\n\n\tvar matInvisible = gizmoMaterial.clone();\n\tmatInvisible.opacity = 0.15;\n\n\tvar matHelper = gizmoMaterial.clone();\n\tmatHelper.opacity = 0.33;\n\n\tvar matRed = gizmoMaterial.clone();\n\tmatRed.color.set( 0xff0000 );\n\n\tvar matGreen = gizmoMaterial.clone();\n\tmatGreen.color.set( 0x00ff00 );\n\n\tvar matBlue = gizmoMaterial.clone();\n\tmatBlue.color.set( 0x0000ff );\n\n\tvar matWhiteTransparent = gizmoMaterial.clone();\n\tmatWhiteTransparent.opacity = 0.25;\n\n\tvar matYellowTransparent = matWhiteTransparent.clone();\n\tmatYellowTransparent.color.set( 0xffff00 );\n\n\tvar matCyanTransparent = matWhiteTransparent.clone();\n\tmatCyanTransparent.color.set( 0x00ffff );\n\n\tvar matMagentaTransparent = matWhiteTransparent.clone();\n\tmatMagentaTransparent.color.set( 0xff00ff );\n\n\tvar matYellow = gizmoMaterial.clone();\n\tmatYellow.color.set( 0xffff00 );\n\n\tvar matLineRed = gizmoLineMaterial.clone();\n\tmatLineRed.color.set( 0xff0000 );\n\n\tvar matLineGreen = gizmoLineMaterial.clone();\n\tmatLineGreen.color.set( 0x00ff00 );\n\n\tvar matLineBlue = gizmoLineMaterial.clone();\n\tmatLineBlue.color.set( 0x0000ff );\n\n\tvar matLineCyan = gizmoLineMaterial.clone();\n\tmatLineCyan.color.set( 0x00ffff );\n\n\tvar matLineMagenta = gizmoLineMaterial.clone();\n\tmatLineMagenta.color.set( 0xff00ff );\n\n\tvar matLineYellow = gizmoLineMaterial.clone();\n\tmatLineYellow.color.set( 0xffff00 );\n\n\tvar matLineGray = gizmoLineMaterial.clone();\n\tmatLineGray.color.set( 0x787878 );\n\n\tvar matLineYellowTransparent = matLineYellow.clone();\n\tmatLineYellowTransparent.opacity = 0.25;\n\n\t// reusable geometry\n\n\tvar arrowGeometry = new CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false );\n\n\tvar scaleHandleGeometry = new BoxBufferGeometry( 0.125, 0.125, 0.125 );\n\n\tvar lineGeometry = new BufferGeometry( );\n\tlineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n\tvar CircleGeometry = function ( radius, arc ) {\n\n\t\tvar geometry = new BufferGeometry( );\n\t\tvar vertices = [];\n\n\t\tfor ( var i = 0; i <= 64 * arc; ++ i ) {\n\n\t\t\tvertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n\tvar TranslateHelperGeometry = function () {\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n\tvar gizmoTranslate = {\n\t\tX: [\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, - Math.PI / 2 ], null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineRed ) ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ - Math.PI / 2, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ], [ 0, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent.clone() ), [ 0.15, 0.15, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t]\n\t};\n\n\tvar pickerTranslate = {\n\t\tX: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ]]\n\t\t]\n\t};\n\n\tvar helperTranslate = {\n\t\tSTART: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tEND: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tDELTA: [\n\t\t\t[ new Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tX: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar gizmoRotate = {\n\t\tX: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, - Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ - 1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, - 1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ]]\n\t\t]\n\t};\n\n\tvar helperRotate = {\n\t\tAXIS: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar pickerRotate = {\n\t\tX: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new Mesh( new SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n\t\t]\n\t};\n\n\tvar gizmoScale = {\n\t\tX: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar pickerScale = {\n\t\tX: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ]],\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ]],\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ]],\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar helperScale = {\n\t\tX: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\t// Creates an Object3D with gizmos described in custom hierarchy definition.\n\n\tvar setupGizmo = function ( gizmoMap ) {\n\n\t\tvar gizmo = new Object3D();\n\n\t\tfor ( var name in gizmoMap ) {\n\n\t\t\tfor ( var i = gizmoMap[ name ].length; i --; ) {\n\n\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ].clone();\n\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\n\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\n\t\t\t\tvar scale = gizmoMap[ name ][ i ][ 3 ];\n\t\t\t\tvar tag = gizmoMap[ name ][ i ][ 4 ];\n\n\t\t\t\t// name and tag properties are essential for picking and updating logic.\n\t\t\t\tobject.name = name;\n\t\t\t\tobject.tag = tag;\n\n\t\t\t\tif ( position ) {\n\n\t\t\t\t\tobject.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( rotation ) {\n\n\t\t\t\t\tobject.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scale ) {\n\n\t\t\t\t\tobject.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tobject.updateMatrix();\n\n\t\t\t\tvar tempGeometry = object.geometry.clone();\n\t\t\t\ttempGeometry.applyMatrix4( object.matrix );\n\t\t\t\tobject.geometry = tempGeometry;\n\t\t\t\tobject.renderOrder = Infinity;\n\n\t\t\t\tobject.position.set( 0, 0, 0 );\n\t\t\t\tobject.rotation.set( 0, 0, 0 );\n\t\t\t\tobject.scale.set( 1, 1, 1 );\n\n\t\t\t\tgizmo.add( object );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn gizmo;\n\n\t};\n\n\t// Reusable utility variables\n\n\tvar tempVector = new Vector3( 0, 0, 0 );\n\tvar tempEuler = new Euler();\n\tvar alignVector = new Vector3( 0, 1, 0 );\n\tvar zeroVector = new Vector3( 0, 0, 0 );\n\tvar lookAtMatrix = new Matrix4();\n\tvar tempQuaternion = new Quaternion();\n\tvar tempQuaternion2 = new Quaternion();\n\tvar identityQuaternion = new Quaternion();\n\n\tvar unitX = new Vector3( 1, 0, 0 );\n\tvar unitY = new Vector3( 0, 1, 0 );\n\tvar unitZ = new Vector3( 0, 0, 1 );\n\n\t// Gizmo creation\n\n\tthis.gizmo = {};\n\tthis.picker = {};\n\tthis.helper = {};\n\n\tthis.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n\tthis.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n\tthis.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n\tthis.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n\tthis.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n\tthis.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n\tthis.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n\tthis.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n\tthis.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n\t// Pickers should be hidden always\n\n\tthis.picker[ \"translate\" ].visible = false;\n\tthis.picker[ \"rotate\" ].visible = false;\n\tthis.picker[ \"scale\" ].visible = false;\n\n\t// updateMatrixWorld will update transformations and appearance of individual handles\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tvar quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n\t\t// Show only gizmos for current transform mode\n\n\t\tthis.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n\t\tthis.helper[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n\t\tvar handles = [];\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\n\n\t\tfor ( var i = 0; i < handles.length; i ++ ) {\n\n\t\t\tvar handle = handles[ i ];\n\n\t\t\t// hide aligned to camera\n\n\t\t\thandle.visible = true;\n\t\t\thandle.rotation.set( 0, 0, 0 );\n\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\tvar factor;\n\n\t\t\tif ( this.camera.isOrthographicCamera ) {\n\n\t\t\t\tfactor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\n\n\t\t\t} else {\n\n\t\t\t\tfactor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\n\n\t\t\t}\n\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 7 );\n\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\n\n\t\t\tif ( handle.tag === 'helper' ) {\n\n\t\t\t\thandle.visible = false;\n\n\t\t\t\tif ( handle.name === 'AXIS' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = !! this.axis;\n\n\t\t\t\t\tif ( this.axis === 'X' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Y' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Z' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\talignVector.copy( this.rotationAxis );\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n\t\t\t\t\t\thandle.quaternion.multiply( tempQuaternion );\n\t\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'E' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else if ( handle.name === 'START' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'END' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPosition );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\n\t\t\t\t\ttempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\n\t\t\t\t\ttempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n\t\t\t\t\thandle.scale.copy( tempVector );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\t\t\tif ( this.dragging ) {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis ) {\n\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== - 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// If updating helper, skip rest of the loop\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// Align handles to current local or world rotation\n\n\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n\t\t\t\t// Hide translate and scale axis facing the camera\n\n\t\t\t\tvar AXIS_HIDE_TRESHOLD = 0.99;\n\t\t\t\tvar PLANE_HIDE_TRESHOLD = 0.2;\n\t\t\t\tvar AXIS_FLIP_TRESHOLD = 0.0;\n\n\n\t\t\t\tif ( handle.name === 'X' || handle.name === 'XYZX' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'YZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Flip translate and scale axis ocluded behind another axis\n\n\t\t\t\tif ( handle.name.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.x *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.y *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.z *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( this.mode === 'rotate' ) {\n\n\t\t\t\t// Align handles to current local or world rotation\n\n\t\t\t\ttempQuaternion2.copy( quaternion );\n\t\t\t\talignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n\t\t\t\tif ( handle.name.search( \"E\" ) !== - 1 ) {\n\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'X' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitX, Math.atan2( - alignVector.y, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Hide disabled axes\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === - 1 || this.showX );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === - 1 || this.showY );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === - 1 || this.showZ );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === - 1 || ( this.showX && this.showY && this.showZ ) );\n\n\t\t\t// highlight selected axis\n\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\n\n\t\t\thandle.material.color.copy( handle.material._color );\n\t\t\thandle.material.opacity = handle.material._opacity;\n\n\t\t\tif ( ! this.enabled ) {\n\n\t\t\t\thandle.material.opacity *= 0.5;\n\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t} else if ( this.axis ) {\n\n\t\t\t\tif ( handle.name === this.axis ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else if ( this.axis.split( '' ).some( function ( a ) {\n\n\t\t\t\t\treturn handle.name === a;\n\n\t\t\t\t} ) ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.material.opacity *= 0.25;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: TransformControlsGizmo,\n\n\tisTransformControlsGizmo: true\n\n} );\n\n\nvar TransformControlsPlane = function () {\n\n\t'use strict';\n\n\tMesh.call( this,\n\t\tnew PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n\t\tnew MeshBasicMaterial( { visible: false, wireframe: true, side: DoubleSide, transparent: true, opacity: 0.1 } )\n\t);\n\n\tthis.type = 'TransformControlsPlane';\n\n\tvar unitX = new Vector3( 1, 0, 0 );\n\tvar unitY = new Vector3( 0, 1, 0 );\n\tvar unitZ = new Vector3( 0, 0, 1 );\n\n\tvar tempVector = new Vector3();\n\tvar dirVector = new Vector3();\n\tvar alignVector = new Vector3();\n\tvar tempMatrix = new Matrix4();\n\tvar identityQuaternion = new Quaternion();\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tthis.position.copy( this.worldPosition );\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tunitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n\t\t// Align the plane for current transform mode, axis and space.\n\n\t\talignVector.copy( unitY );\n\n\t\tswitch ( this.mode ) {\n\n\t\t\tcase 'translate':\n\t\t\tcase 'scale':\n\t\t\t\tswitch ( this.axis ) {\n\n\t\t\t\t\tcase 'X':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitX );\n\t\t\t\t\t\tdirVector.copy( unitX ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Y':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitY );\n\t\t\t\t\t\tdirVector.copy( unitY ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitZ ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XY':\n\t\t\t\t\t\tdirVector.copy( unitZ );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'YZ':\n\t\t\t\t\t\tdirVector.copy( unitX );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XZ':\n\t\t\t\t\t\talignVector.copy( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitY );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XYZ':\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tdirVector.set( 0, 0, 0 );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'rotate':\n\t\t\tdefault:\n\t\t\t\t// special case for rotate\n\t\t\t\tdirVector.set( 0, 0, 0 );\n\n\t\t}\n\n\t\tif ( dirVector.length() === 0 ) {\n\n\t\t\t// If in rotate mode, make the plane parallel to camera\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\n\n\t\t} else {\n\n\t\t\ttempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( tempMatrix );\n\n\t\t}\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: TransformControlsPlane,\n\n\tisTransformControlsPlane: true\n\n} );\n\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}